---
import Layout from '../layouts/Layout.astro';
import { getCollection } from 'astro:content';
import Carousel from '../components/Carousel.astro';

const albums = await getCollection('albums');
export const prerender = true;
---

<Layout title="kvibeshopcl | Cat√°logo ‚ú®">
  <main class="flex flex-col items-center w-full min-h-screen pt-2 pb-10 px-4 bg-white">
    <Carousel />
    <div class="w-full max-w-md mb-12">
      <input 
        type="text" 
        id="search-input"
        placeholder="Buscar por grupo o √°lbum..." 
        class="w-full p-4 border-2 border-purple-100 rounded-full focus:border-purple-500 outline-none transition-all shadow-sm text-sm"
      />
    </div>
    
      <h1 class="text-xl md:text-xl font-black uppercase tracking-tighter text-purple-900 mb-4">
       . ›Å‚Çä ‚äπ . ›Å ‚ü° ›Å . ‚äπ ‚Çä ›Å. Cat√°logo de √Ålbumes . ›Å‚Çä ‚äπ . ›Å ‚ü° ›Å . ‚äπ ‚Çä ›Å.
      </h1>
      
    
    <section class="w-full max-w-6xl mx-auto">
      <div id="album-grid" class="grid grid-cols-2 md:grid-cols-4 gap-8">
        {
          albums.map((album) => {
            const { id, data } = album;
            const { title, img, price } = data;

            return (
              <article class="album-card flex flex-col items-center" data-title={title.toLowerCase()}>
                <a href={`/album/${id}`} class="w-full aspect-square overflow-hidden rounded-xl shadow-lg mb-4">
                  <img src={`/${img}`} alt={title} class="w-full h-full object-cover" />
                </a>
                <h2 class="text-xs font-bold uppercase text-purple-900 line-clamp-1">{title}</h2>
                <p class="text-purple-700 font-black">{price}</p>
              </article>
            )
          })
        }
      </div>

      <div id="no-results" class="hidden text-center py-20 text-gray-400 italic">
        No hay resultados para tu b√∫squeda ü•≤
      </div>
    </section>
<section class="w-full max-w-6xl mx-auto px-6 py-20 mt-10 border-t border-gray-50">
      <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
        
        <article class="flex flex-col items-center text-center p-10 bg-white rounded-[2.5rem] border border-purple-300 shadow-sm transition-all hover:shadow-xl hover:shadow-purple-500/5 group">
          <div class="w-14 h-14 bg-pink-50 rounded-2xl flex items-center justify-center mb-6 group-hover:scale-110 transition-transform">
            <span class="text-3xl">üì±</span>
          </div>
          <h3 class="text-purple-900 font-black uppercase tracking-tighter mb-3">Cat√°logo Digital 24/7</h3>
          <p class="text-gray-400 text-sm leading-relaxed text-balance">Explora y elige tus favoritos en cualquier momento; el proceso finaliza en nuestro Instagram</p>
        </article>

        <article class="flex flex-col items-center text-center p-10 bg-white rounded-[2.5rem] border border-purple-300 shadow-sm transition-all hover:shadow-xl hover:shadow-purple-500/5 group">
          <div class="w-14 h-14 bg-pink-50 rounded-2xl flex items-center justify-center mb-6 group-hover:scale-110 transition-transform">
            <span class="text-3xl">‚ú®</span>
          </div>
          <h3 class="text-purple-900 font-black uppercase tracking-tighter mb-3">Atenci√≥n por Instagram</h3>
          <p class="text-gray-400 text-sm leading-relaxed text-balance">Contacto directo y personalizado por DM para resolver tus dudas antes de transferir</p>
        </article>

        <article class="flex flex-col items-center text-center p-10 bg-white rounded-[2.5rem] border border-purple-300 shadow-sm transition-all hover:shadow-xl hover:shadow-purple-500/5 group">
          <div class="w-14 h-14 bg-pink-50 rounded-2xl flex items-center justify-center mb-6 group-hover:scale-110 transition-transform">
            <span class="text-3xl">üá∞üá∑</span>
          </div>
          <h3 class="text-purple-900 font-black uppercase tracking-tighter mb-3 text-balance leading-none">Productos 100% Originales</h3>
          <p class="text-gray-400 text-sm leading-relaxed text-balance">Mercanc√≠a oficial importada directamente desde Corea para garantizar tu colecci√≥n</p>
        </article>

      </div>
    </section>
  </main>
</Layout>

<script>
  document.addEventListener('astro:page-load', () => {
    const searchInput = document.querySelector('#search-input') as HTMLInputElement;
    const cards = document.querySelectorAll('.album-card');
    const noResults = document.querySelector('#no-results');

    if (searchInput) {
      searchInput.addEventListener('input', () => {
        const query = searchInput.value.toLowerCase();
        let found = false;

        cards.forEach(card => {
          const title = card.getAttribute('data-title') || '';
          if (title.includes(query)) {
            (card as HTMLElement).style.display = 'flex';
            found = true;
          } else {
            (card as HTMLElement).style.display = 'none';
          }
        });

        if (found) {
          noResults?.classList.add('hidden');
        } else {
          noResults?.classList.remove('hidden');
        }
      });
    }
  });
</script>

<style>
.logo-small {
    height: 72px; 
    width: auto;  
    object-fit: contain;
    border: 0;
    outline: none;
    user-select: none;
    pointer-events: none;
    transition: none!important; 
  }

  @media (max-width: 768px) {
  .logo-small {
      height: 48px; 
    }
  }
</style>